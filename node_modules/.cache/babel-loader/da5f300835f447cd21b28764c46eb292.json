{"ast":null,"code":"import _regeneratorRuntime from \"F:\\\\NoteJS\\\\final\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"F:\\\\NoteJS\\\\final\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport * as types from '../Config/authConstant';\nimport API from '../utils/api';\nimport history from '../Config/history';\nimport axios from 'axios';\nexport var getUser = function getUser() {\n  return (\n    /*#__PURE__*/\n    function () {\n      var _ref = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(dispatch) {\n        var user;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                user = JSON.parse(localStorage.getItem('authentication'));\n                dispatch({\n                  type: types.GET_USER,\n                  payload: user\n                });\n\n              case 2:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }()\n  );\n};\n\nvar loginRequest = function loginRequest(userID) {\n  return (\n    /*#__PURE__*/\n    function () {\n      var _ref2 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee2(dispatch) {\n        var response;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.prev = 0;\n                _context2.next = 3;\n                return API.get(\"/userany/\".concat(userID));\n\n              case 3:\n                response = _context2.sent;\n                localStorage.setItem('authentication', JSON.stringify({\n                  id: response.data.id,\n                  name: response.data.username,\n                  avatar: response.data.avatar\n                }));\n                dispatch({\n                  type: types.GETALL_SUCCESS\n                });\n                history.push('/manager');\n                _context2.next = 13;\n                break;\n\n              case 9:\n                _context2.prev = 9;\n                _context2.t0 = _context2[\"catch\"](0);\n\n                if (_context2.t0.response.status === 400) {\n                  window.location.reload();\n                }\n\n                dispatch({\n                  type: types.GETALL_FAILURE,\n                  payload: _context2.t0.message\n                });\n\n              case 13:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, null, [[0, 9]]);\n      }));\n\n      return function (_x2) {\n        return _ref2.apply(this, arguments);\n      };\n    }()\n  );\n};\n\nexport var login = function login(usernameOrEmail, password) {\n  return (\n    /*#__PURE__*/\n    function () {\n      var _ref3 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee3(dispatch) {\n        var _ref4, data;\n\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.prev = 0;\n                _context3.next = 3;\n                return API.post('/auth/signin', {\n                  usernameOrEmail: usernameOrEmail,\n                  password: password\n                });\n\n              case 3:\n                _ref4 = _context3.sent;\n                data = _ref4.data;\n                _context3.next = 7;\n                return localStorage.setItem('accessToken', data.accessToken);\n\n              case 7:\n                window.axios.headers.common['Authorization'] = 'Bearer ' + localStorage.getItem('accessToken');\n                dispatch({\n                  type: types.LOGIN_SUCCESS,\n                  payload: data\n                });\n                dispatch(loginRequest(data.userID));\n                _context3.next = 15;\n                break;\n\n              case 12:\n                _context3.prev = 12;\n                _context3.t0 = _context3[\"catch\"](0);\n                dispatch({\n                  type: types.LOGIN_FAILURE,\n                  payload: _context3.t0.message\n                });\n\n              case 15:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, null, [[0, 12]]);\n      }));\n\n      return function (_x3) {\n        return _ref3.apply(this, arguments);\n      };\n    }()\n  );\n};\nexport var register = function register(name, username, email, password) {\n  return (\n    /*#__PURE__*/\n    function () {\n      var _ref5 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee4(dispatch) {\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                _context4.prev = 0;\n                _context4.next = 3;\n                return API.post('/auth/signup', {\n                  name: name,\n                  username: username,\n                  email: email,\n                  password: password\n                });\n\n              case 3:\n                dispatch({\n                  type: types.REGISTER_SUCCESS\n                });\n                history.push('/login', {\n                  register: 'success'\n                });\n                _context4.next = 10;\n                break;\n\n              case 7:\n                _context4.prev = 7;\n                _context4.t0 = _context4[\"catch\"](0);\n                //const {data}=await API.post('/auth/signup', { name, username, email, password })\n                dispatch({\n                  type: types.REGISTER_FAILURE,\n                  payload: _context4.t0.message\n                });\n\n              case 10:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, null, [[0, 7]]);\n      }));\n\n      return function (_x4) {\n        return _ref5.apply(this, arguments);\n      };\n    }()\n  );\n};\nexport var logout = function logout() {\n  return (\n    /*#__PURE__*/\n    function () {\n      var _ref6 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee5(dispatch) {\n        return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                try {\n                  localStorage.removeItem('authentication');\n                  localStorage.removeItem('token');\n                  dispatch({\n                    type: types.LOGOUT\n                  });\n                  history.push('/login');\n                } catch (err) {\n                  if (err.response.status === 401) {\n                    history.push('/login');\n                  }\n\n                  console.log(err);\n                }\n\n              case 1:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5);\n      }));\n\n      return function (_x5) {\n        return _ref6.apply(this, arguments);\n      };\n    }()\n  );\n};","map":{"version":3,"sources":["F:\\NoteJS\\final\\src\\actions\\userActions.js"],"names":["types","API","history","axios","getUser","dispatch","user","JSON","parse","localStorage","getItem","type","GET_USER","payload","loginRequest","userID","get","response","setItem","stringify","id","data","name","username","avatar","GETALL_SUCCESS","push","status","window","location","reload","GETALL_FAILURE","message","login","usernameOrEmail","password","post","accessToken","headers","common","LOGIN_SUCCESS","LOGIN_FAILURE","register","email","REGISTER_SUCCESS","REGISTER_FAILURE","logout","removeItem","LOGOUT","err","console","log"],"mappings":"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","sourcesContent":["import * as types from '../Config/authConstant';\r\nimport API from '../utils/api';\r\nimport history from '../Config/history';\r\nimport axios from 'axios'\r\n\r\nexport const getUser = () => async (dispatch) => {\r\n  const user = JSON.parse(localStorage.getItem('authentication'));\r\n  dispatch({ type: types.GET_USER, payload: user })\r\n\r\n}\r\nconst loginRequest = (userID) => async (dispatch) => {\r\n  try {\r\n    const response = await API.get(`/userany/${userID}`)\r\n    localStorage.setItem(\r\n      'authentication',\r\n      JSON.stringify({ id: response.data.id, name: response.data.username, avatar: response.data.avatar }),\r\n    )\r\n    dispatch({ type: types.GETALL_SUCCESS })\r\n    history.push('/manager')\r\n  }\r\n  catch (err) {\r\n    if (err.response.status === 400) {\r\n      window.location.reload()\r\n    }\r\n    dispatch({ type: types.GETALL_FAILURE, payload: err.message })\r\n  }\r\n}\r\nexport const login = (usernameOrEmail, password) => async (dispatch) => {\r\n  try {\r\n    const { data } = await API.post('/auth/signin', { usernameOrEmail, password })\r\n    await localStorage.setItem('accessToken', data.accessToken)\r\n    window.axios.headers.common['Authorization'] = 'Bearer ' + localStorage.getItem('accessToken')\r\n    dispatch({ type: types.LOGIN_SUCCESS, payload: data })\r\n    dispatch(loginRequest(data.userID))\r\n  } catch (err) {\r\n    dispatch({ type: types.LOGIN_FAILURE, payload: err.message })\r\n  }\r\n\r\n}\r\nexport const register = (name, username, email, password) => async (dispatch) => {\r\n  try {\r\n    await API.post('/auth/signup', { name, username, email, password })\r\n\r\n    dispatch({ type: types.REGISTER_SUCCESS })\r\n    history.push('/login', { register: 'success' })\r\n\r\n  } catch (err) {\r\n    //const {data}=await API.post('/auth/signup', { name, username, email, password })\r\n    dispatch({ type: types.REGISTER_FAILURE, payload: err.message })\r\n  }\r\n}\r\n\r\nexport const logout = () => async (dispatch) => {\r\n  try {\r\n    localStorage.removeItem('authentication')\r\n    localStorage.removeItem('token')\r\n    dispatch({ type: types.LOGOUT })\r\n    history.push('/login')\r\n  } catch (err) {\r\n    if (err.response.status === 401) {\r\n      history.push('/login')\r\n    }\r\n    console.log(err)\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}